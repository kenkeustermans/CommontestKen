/*!
 * Postman BDD v5.0.6 (April 8th 2018)
 * 
 * https://bigstickcarpet.github.io/postman-bdd
 * 
 * @author  Ken Keustermans
 * Copyright(c) James Messinger (http://bigstickcarpet.com)
 */
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.postmanBDD=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";var url=require("url"),cookies=require("./cookies"),ipV4Pattern=/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}$/,ipV6Pattern=/^(?:(?:[0-9a-fA-F:]){1,4}(?:(?::(?:[0-9a-fA-F]){1,4}|:)){2,7})+$/,contentTypes={json:"application/json",text:"text/plain",html:"text/html",xml:"application/xml"};function chaiHttp(e,t){var o=e.Assertion;o.addMethod("status",function(e){new o(this._obj).to.have.property("status");var t=this._obj.status;this.assert(t===e,"expected the response to have status code #{exp} but got #{act}","expected the response to not have status code #{act}",e,t)}),o.addProperty("headers",function(){var e=this._obj.method?"request":"response";this.assert(Object.keys(this._obj.headers||{}).length>0,"expected the "+e+" to have headers","expected the "+e+" to not have any headers")}),o.addMethod("header",function(e,t){var o=getHeader(this._obj,e),a=void 0!==o&&null!==o;arguments.length<2?this.assert(a,"expected header #{exp} to exist","expected header #{exp} to not exist",e,o):t instanceof RegExp?this.assert(a&&t.test(o),"expected header '"+e+"' to match #{exp} but got #{act}","expected header '"+e+"' to not match #{exp} but got #{act}",t,a?o:"<header-not-set>"):this.assert(a&&o===t,"expected header '"+e+"' to have value #{exp} but got #{act}","expected header '"+e+"' to not have value #{exp}",t,a?o:"<header-not-set>")}),o.addProperty("ip",function(){var e=ipV4Pattern.test(this._obj)||ipV6Pattern.test(this._obj);this.assert(e,"expected #{this} to be an ip","expected #{this} to not be an ip")}),Object.keys(contentTypes).forEach(function(e){var t=contentTypes[e];o.addProperty(e,function(){var o=getHeader(this._obj,"content-type");this.assert(o&&o.indexOf(t)>=0,"expected the response type to be #{exp} but got #{act}","expected the response type to not be #{exp} (#{act})",e,o||"<content-type-not-set>")})}),o.addProperty("redirect",function(){var e=this._obj.status;this.assert(wasRedirected(this._obj),"expected redirect status code but got "+e,"expected not to redirect but got "+e+" status")}),o.addMethod("redirectTo",function(e){var t=this._obj.redirects,o=wasRedirected(this._obj),a=this._obj.status,s=getHeader(this._obj,"location");t&&t.length?this.assert(t.indexOf(e)>-1,"expected redirect to "+e+" but got "+t.join(" then "),"expected not to redirect to "+e+" but got "+t.join(" then ")):this.assert(o&&s===e,"expected redirect to #{exp} but got #{act}","expected not to redirect to #{exp}",e,o?s:a)}),o.addProperty("params",function(){var e=url.parse(this._obj.url,!0).query;this.assert(Object.keys(e).length>0,"expected the request to have query parameters","expected the request to not have any query parameters")}),o.addMethod("param",function(e,t){var o=url.parse(this._obj.url,!0).query[e],a=void 0!==o&&null!==o;arguments.length<2?this.assert(a,"expected query parameter #{exp} to exist","expected query parameter #{exp} to not exist",e,o):t instanceof RegExp?this.assert(a&&t.test(o),"expected query parameter '"+e+"' to match #{exp} but got #{act}","expected query parameter '"+e+"' to not match #{exp} but got #{act}",t,a?o:"<parameter-does-not-exist>"):this.assert(a&&o===t,"expected query parameter '"+e+"' to have value #{exp} but got #{act}","expected query parameter '"+e+"' to not have value #{exp}",t,a?o:"<parameter-does-not-exist>")}),o.addProperty("cookies",function(){var e=this._obj.method?"request":"response",t=getCookies(this._obj);this.assert(t.length>0,"expected the "+e+" to have cookies","expected the "+e+" to not have any cookies")}),o.addMethod("cookie",function(e,t){var o=getCookie(this._obj,e)||{},a=void 0!==o.value&&null!==o.value;arguments.length<2?this.assert(a,"expected cookie #{exp} to exist","expected cookie #{exp} to not exist",e,o.value):t instanceof RegExp?this.assert(a&&t.test(o.value),"expected cookie '"+e+"' to match #{exp} but got #{act}","expected cookie '"+e+"' to not match #{exp} but got #{act}",t,a?o.value:"<cookie-not-set>"):this.assert(a&&o.value===t,"expected cookie '"+e+"' to have value #{exp} but got #{act}","expected cookie '"+e+"' to not have value #{exp}",t,a?o.value:"<cookie-not-set>")}),e.Assertion.addMethod("schema",function(e){var o=tv4.validate(this._obj,e),a=t.flag(this,"negate");if(o&&a||!o&&!a){var s=tv4.error.dataPath,r=tv4.error.schemaPath,i=tv4.error.message;if(s)i=s.substr(1).split("/").join(".")+" is invalid. "+i;var n=new SyntaxError(i);throw n.dataPath=s,n.schemaPath=r,n}})}function getHeader(e,t){if(e.getHeader)return e.getHeader(t);t=(t||"").toLowerCase();for(var o=Object.keys(e.headers),a=0;a<o.length;a++)if(o[a].toLowerCase()===t)return e.headers[o[a]]}function getCookies(e){if(e.cookies)return e.cookies;var t=getHeader(e,"cookie");return cookies.parseRequestCookies(t)}function getCookie(e,t){if(e.getCookie)return e.getCookie(t);var o=getCookies(e);return cookies.getCookie(o,t)}function wasRedirected(e){var t=e.redirects,o=e.status;return[301,302,303,307,308].indexOf(o)>=0||t&&t.length}module.exports=chaiHttp},{"./cookies":3,url:54}],2:[function(require,module,exports){"use strict";var Runnable=require("./runnable"),Hook=require("./hook"),State=require("./state");function PostmanBDD(){var t=this.state=new State;this.hooks={before:new Hook("before",t),after:new Hook("after",t),beforeEach:new Hook("beforeEach",t),afterEach:new Hook("afterEach",t)},this.before=PostmanBDD.prototype.before.bind(this),this.after=PostmanBDD.prototype.after.bind(this),this.beforeEach=PostmanBDD.prototype.beforeEach.bind(this),this.afterEach=PostmanBDD.prototype.afterEach.bind(this),this.describe=PostmanBDD.prototype.describe.bind(this),this.it=PostmanBDD.prototype.it.bind(this)}module.exports=PostmanBDD,PostmanBDD.prototype.before=function(t,e){this.hooks.before.push(t,e)},PostmanBDD.prototype.after=function(t,e){this.hooks.after.push(t,e)},PostmanBDD.prototype.beforeEach=function(t,e){this.hooks.beforeEach.push(t,e)},PostmanBDD.prototype.afterEach=function(t,e){this.hooks.afterEach.push(t,e)},PostmanBDD.prototype.describe=function(t,e){var o=new Runnable("describe",this.state,t,e);return this.state.stack.push(o),this.oneTimeInitialization(),o.run(),this.state.isFinished()&&this.hooks.after.run(),this.state.stack.pop(),this.state.results},PostmanBDD.prototype.it=function(t,e){var o=new Runnable("it",this.state,t,e);return this.state.stack.push(o),this.oneTimeInitialization(),this.hooks.beforeEach.run(),o.run(),this.hooks.afterEach.run(),this.state.stack.pop(),o.result},PostmanBDD.prototype.oneTimeInitialization=function(){this.state.isStarted()||this.hooks.before.run()}},{"./hook":4,"./runnable":9,"./state":10}],3:[function(require,module,exports){"use strict";var CookieJar=require("cookiejar").CookieJar,CookieAccessInfo=require("cookiejar").CookieAccessInfo;module.exports={getCookie:function(e,o){return o=(o||"").toLowerCase(),e.find(function(e){return e&&e.name.toLowerCase()===o})},parseRequestCookies:function(e){var o=new CookieJar;if(e){var r=e.split(";").map(function(e){return e.trim()});o.setCookies(r)}return o.getCookies(CookieAccessInfo.All)},parseResponseCookies:function(e){var o=new CookieJar;return e&&o.setCookies(e),o.getCookies(CookieAccessInfo.All)}}},{cookiejar:46}],4:[function(require,module,exports){"use strict";var Runnable=require("./runnable");function Hook(t,s){this.type=t,this.state=s,this.runnables=[]}module.exports=Hook,Hook.prototype.run=function(){var t=this;this.state.inAHook()||this.runnables.forEach(function(s){t.state.stack.push(s),s.run(),t.state.stack.pop()})},Hook.prototype.push=function(t,s){var n=new Runnable(this.type,this.state,t,s);n.isHook=!0,this.runnables.push(n)}},{"./runnable":9}],5:[function(require,module,exports){var PostmanBDD=require("./bdd"),superAgent=require("./response"),assertions=require("./assertions"),options=require("./options"),log=require("./log");function initPostmanBDD(){log.info("Using Postman BDD"),initBDD(),initSuperAgent(),initChai()}function initBDD(){var e=new PostmanBDD;before=e.before,after=e.after,beforeEach=e.beforeEach,afterEach=e.afterEach,describe=e.describe,it=e.it}function initSuperAgent(){response=new superAgent.Response}function initChai(){chai=require("chai"),assert=chai.assert,expect=chai.expect,chai.should(),chai.use(assertions)}module.exports=options,module.exports.reset=initPostmanBDD,initPostmanBDD()},{"./assertions":1,"./bdd":2,"./log":6,"./options":7,"./response":8,chai:13}],6:[function(require,module,exports){"use strict";var options=require("./options"),levels=["silent","error","warn","info","debug"],log=module.exports={isEnabled:function(e){return levels.indexOf(options.logLevel)>=levels.indexOf(e)},errorToPOJO:function(e){if(e&&"object"==typeof e)return Object.keys(e).concat(["name","message","stack"]).reduce(function(o,n){return o[n]=e[n],o},{})}};levels.forEach(function(e){log[e]=function(){if(this.isEnabled(e)){var o=console.log;"function"==typeof console[e]&&(o=console[e]),o.apply(console,arguments)}}})},{"./options":7}],7:[function(require,module,exports){"use strict";module.exports={logLevel:"warn"}},{}],8:[function(require,module,exports){"use strict";var log=require("./log"),cookies=require("./cookies");function Response(){this.status="object"==typeof responseCode?responseCode.code:0,this.statusType=Math.floor(this.status/100),this.info=1===this.statusType,this.ok=2===this.statusType,this.redirect=3===this.statusType,this.clientError=4===this.statusType,this.serverError=5===this.statusType,this.error=this.clientError||this.serverError,this.accepted=202===this.status,this.noContent=204===this.status||1223===this.status,this.badRequest=400===this.status,this.unauthorized=401===this.status,this.notAcceptable=406===this.status,this.notFound=404===this.status,this.forbidden=403===this.status,this.time="number"==typeof responseTime?responseTime:0,this.headers=this.header=parseHeaders();var e=this.getHeader("content-type")||"",s=/charset=([a-zA-Z0-9_-]+)/i.exec(e);this.type=e.split(";")[0],this.charset=s?s[1]:"",this.cookies=parseCookies(this),this.text="string"==typeof responseBody?responseBody:"",this.body=parseResponeBody(this)}function parseHeaders(){if("object"==typeof responseHeaders){var e=pojo(responseHeaders),s={};return Object.keys(e).forEach(function(t){s[t.toLowerCase()]=e[t]}),s}return{}}function parseCookies(e){if("object"==typeof responseCookies&&responseCookies.length>0)return responseCookies;var s=e.getHeader("set-cookie");return cookies.parseResponseCookies(s)}function parseResponeBody(e){if(e.type.indexOf("json")>=0)try{return JSON.parse(e.text)}catch(e){log.error("Unable to parse the response body as JSON",log.errorToPOJO(e))}if(e.type.indexOf("xml")>=0)try{return pojo(xml2Json(e.text))}catch(e){log.error("Unable to parse the response body as XML",log.errorToPOJO(e))}return e.text}function pojo(e){return JSON.parse(JSON.stringify(e))}module.exports={Response:Response},Response.prototype.getHeader=function(e){return"object"==typeof postman&&"function"==typeof postman.getResponseHeader?postman.getResponseHeader(e):(e=(e||"").toLowerCase(),this.headers[e])},Response.prototype.getCookie=function(e){return"object"==typeof postman&&"function"==typeof postman.getResponseCookie?postman.getResponseCookie(e):cookies.getCookie(this.cookies,e)}},{"./cookies":3,"./log":6}],9:[function(require,module,exports){"use strict";var log=require("./log");function Runnable(t,s,e,i){"function"==typeof e&&(i=e,e=""),s.counters[t]++;var r="it"===t?"test":t;this.type=t,this.state=s,this.isHook=!1,this.isNamed=!!e,this.title=e||r+" #"+s.counters[t],this.fn=i,this.result=null,this.error=null}module.exports=Runnable,Runnable.prototype.run=function(){var t=this.state.currentPath();log.debug("Running "+t),"describe"!==this.type&&(this.state.results[t]=null);try{this.fn(),this.success(t)}catch(s){this.failure(s,t)}},Runnable.prototype.success=function(t){log.info("passed: "+t),this.result=!0,"describe"!==this.type&&(this.state.results[t]=!0)},Runnable.prototype.failure=function(t,s){log.error("failed: "+s,log.errorToPOJO(t)),this.result=!1,this.error=t,delete this.state.results[s],this.state.results[s+" ("+t.message+")"]=!1}},{"./log":6}],10:[function(require,module,exports){"use strict";function State(){this.results=resetTests(),this.stack=[],this.counters={describe:0,it:0,before:0,after:0,beforeEach:0,afterEach:0},this._pathCounter=0}function resetTests(){if("object"!=typeof tests)throw new Error('Postman BDD can only run inside the Postman scripting runtime (the "tests" global variable is missing)');return Object.keys(tests).forEach(function(t){delete tests[t]}),tests}module.exports=State,State.prototype.currentPath=function(){var t=this.stack[this.stack.length-1],e="";if(("describe"!==t.type&&(e=++this._pathCounter+". "),"before"===t.type||"after"===t.type)&&!this.stack.some(function(t){return"describe"===t.type&&t.isNamed}))return e+t.title;return e+=this.stack.map(function(t){return t.title}).join(" - ")},State.prototype.isStarted=function(){return this._pathCounter>0},State.prototype.isFinished=function(){return 1===this.stack.length&&this.counters.describe>0},State.prototype.inAHook=function(){return this.stack.some(function(t){return t.isHook})}},{}],11:[function(require,module,exports){
